# Визуалиация данных и работа с графами

### Voyant Tools

[Voyant Tools](https://voyant-tools.org/) -- веб-приложение для анализа текста.

[Вот здесь](http://docs.voyant-tools.org/start/) документация по самым азам работы с ним, [вот здесь](http://docs.voyant-tools.org/tools/) -- описание всех доступных инструментов, а [вот здесь](http://docs.voyant-tools.org/about/examples-gallery/) -- примеры исследований, сделанных с его помощью.

В языке есть служебные слова, которые нам обычно не нужны для текстовой аналитики. Чтобы их отфильтровать, используются списки стоп-слов. В voyant-tools есть встроенные списки стоп-слов для многих языков, но можно их задать самостоятельно. Вот, например, [мой список русских стоп-слов](https://www.dropbox.com/s/onmfg7gztfddyxl/rus_stopwords.txt?dl=0) для художественной литературы, составленный на основе яндексовского.

Можно потренироваться на любом тексте -- например, на ["Капитанской дочке"](https://www.dropbox.com/s/aky2md6724r3yww/капитанская дочка.txt?dl=0) А.С. Пушкина.

### Облака тегов

**Облако тегов** _\(word cloud\)_ -- это визуализация ключевых слов \(тегов\) из какого-либо текста, где размер слова указывает на его частотность. Такая картинка украсит любую научную работу. :\) Существует много простых и удобных онлайн-сервисов для создания облаков тегов; вот некоторые из них.

* [Word Clouds](https://www.wordclouds.com/) -- тонкие настройки, разные формы облаков, фильтрация стоп-слов, можно загрузить файл
* [Wordle](http://www.wordle.net) -- настройка формы облака, шрифта и цвета слов, работа с небольшими текстами
* [Word It Out](https://worditout.com) -- настройки цвета и размера слов, работа с небольшими текстами
* [Tagxedo](http://www.tagxedo.com/app.html) -- настройка ориентации слов, цветовой схемы, формы облака
* [Word Cloud by Jason Davies](https://www.jasondavies.com/wordcloud/) -- настройка количества слов и их ориентации

Пример облака тегов по статье '"Cats" из Википедии, нарисованного с помощью сервиса Word Clouds.

![](/assets/wordcloud3.png)

Можно использовать не только встроенные формы, но и загружать свои картинки \(облако нарисовано по первой главе романа Дж. Джойса "Улисс"\).

![](/assets/wordcloud5.png)

### Графы и Gephi

#### Что такое граф?

**Граф** -- это модель, состоящая из **узлов** и связей между ними, или** ребер**. По-английски это называется _nodes \(vertices\)_ и _edges_. Узлы в графах могут группироваться в сообщества. **Сообщество** -- это плотный подграф, где все \(или почти все\) узлы связаны между собой. Графы бывают:

* направленные и ненаправленные \(связи-стрелочки vs обычные связи\)
* связанные и несвязанные \(все узлы связаны vs есть узлы, которые оторваны от основного графа\).
* взвешенные и невзвешенные \(связи имеют некоторое числовое значение или нет\)

В лекции вы видели много разнообразных примеров графов, вот еще один. :\) Здесь станции -- это узлы, а перегоны -- ребра. Когда вы рассчитываете расстояние в пути, вы работаете со взвешенным графом: каждый перегон оценивается в несколько минут.

![](/assets/pastedImage0.png)

А вот так выглядит интернет!

![](/assets/rsz_internet_network.png)

#### 

#### Метрики

**Метрика** -- это результат измерений, проведенных определенным способом. Представьте, что вы выбираете материал для реферата на тему "Слово о полку Игореве": у вас есть оригинальный текст в 50 страниц, современная книга А.А. Зализняка "Слово о полку Игореве: взгляд лингвиста" в 500 страниц и англоязычная статья "The Igor Tales and Their Folkloric Background" в 100 страниц. Если метрикой для вас является количество страниц, то вы выберете оригинальный текст, а если простота чтения -- то современную книжку.

**Степень, или мощность узла** _\(degree\)_ -- это количество его связей.

**Взвешенная степень** _\(weighed degree\)_ - - это количество связей узла, разделенное на общее количество связей в графе.

Важность узла в графе можно определять разными способами:

* **degree centrality**: у кого больше связей, тот и важнее
* **closeness centrality**: чем центральнее узел \(т.е. чем короче путь от него до всех остальных узлов\), тем он важнее
* **betweenness centrality**: чем больше раз узел связывает два других узла, тем он важнее
* **eigencentrality**: чем больше друзей у твоих друзей, тем ты важнее

**Коэффициент ассортативности** _\(assortativity coefficient\) _определяет, с кем связаны "важные" узлы: если с другими "важными" узлами, то значение коэффициента высокое, а если нет -- низкое.

**Коэффициент кластеризации** _\(clustering coefficient\) _-- степень взаимодействия между собой ближайших соседей узла, т.е. вероятность того, что ближайшие соседи узла будут связаны не только с ним, но и между собой.

**Плотность графа** _\(density\)_ -- отношение числа ребер к максимально возможному. В сообществах высокий коэффициент кластеризации и высокая плотность.

**Модулярность** _\(modularity\) _показывает, насколько при заданном разбиении графа на группы плотность связей внутри группы больше плотности связей между группами. С помощью этой метрики граф разбивается на сообщества.

#### Форматы графов

Граф записывается в виде текстового \(.gml\) или XML-файла \(.graphml, .gexf\), где перечисляются все узлы, ребра и их атрибуты -- например, степень узла или вес ребра. Вот так выглядят файлы .gml и .gexf соответственно.

![](/assets/grapg6.png)

![](/assets/graph7.png)

#### Gephi

**Gephi** -- программа для визуализации графов. Скачать ее можно [отсюда](https://gephi.org/), а [вот здесь ](https://gephi.org/users/)инструкция по работе с ней. Мы будем тренироваться на графе по роману "Отверженные" Виктора Гюго, который можно скачать [отсюда](http://www-personal.umich.edu/~mejn/netdata/lesmis.zip). Еще больше интересных графовых данных для самостоятельной работы вы найдете [вот здесь](http://www-personal.umich.edu/~mejn/netdata/) и [вот здесь](http://konect.uni-koblenz.de/).

С помощью Gephi можно делать очень красивые картинки. Вот несколько примеров из работ польского специалиста по стилометрии Яна Рыбицки.

1. **Хронология романов Ч. Диккенса по наиболее частотным словам **![](/assets/image2.png)
2. **Хронология английской литературы, 100 романов  **![](/assets/image4.png)
3. **Это граф русских романов XIX века, построенный командой тьюториала по стилометрии на II московско-тартусской школе по Digital Humanities **![](/assets/import1111.png)
4. **А вот мой пример с героями древнеирландских саг **![](/assets/Ulster_ForceAtlas_Fixed_Cropped.png)

Графы можно не только сохранять как картинки, но и публиковать в интернете \(например, на GitHub\) с помощью плагина Sigma. Вот [пример интерактивного графа](https://yosej.github.io/Ossian_Full_Network/) по Оссиановским поэмам Макферсона.

А теперь давайте разберемся, как все это это сделать.

